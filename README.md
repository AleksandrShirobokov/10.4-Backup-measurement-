# 10.4 «Резервное копирование»
# Александр Широбоков
## Задание 1. В чём разница между полным, дифференциальным, инкрементным резервным копированием.
 - Полное резервное копирование (Full backup) - это процесс создания резервной копии всех данных и файлов на компьютере или сервере в один момент времени. Это означает, что при полном резервном копировании все данные и файлы копируются каждый раз, когда резервная копия создается. Полное резервное копирование занимает больше времени и места на диске, чем другие виды резервного копирования, но позволяет восстановить все данные за один раз.

 - Дифференциальное резервное копирование (Differential backup) - это процесс создания резервной копии только тех данных, которые изменились с момента последнего полного резервного копирования. То есть, при дифференциальном резервном копировании копируются только измененные данные с момента последнего полного копирования. Дифференциальное резервное копирование занимает меньше времени и места на диске, чем полное резервное копирование, но для восстановления данных необходимо выполнить последовательно полное резервное копирование и все дифференциальные копии.

 - Инкрементное резервное копирование (Incremental backup) - это процесс создания резервной копии только тех данных, которые изменились с момента последнего резервного копирования (полного или инкрементального). То есть, при инкрементальном резервном копировании копируются только измененные данные с момента последнего резервного копирования (полного или инкрементального). Инкрементное резервное копирование занимает меньше времени и места на диске, чем полное и дифференциальное резервное копирование, и позволяет восстановить данные путем последовательного восстановления всех инкрементальных копий с момента последнего полного копирования.

Каждый из этих методов имеет свои преимущества и недостатки, и выбор метода зависит от конкретных потребностей и требований организации. Например, полное резервное копирование может быть предпочтительным для организаций с малым объемом данных и высокой частотой изменений, тогда как инкрементное резервное копирование может быть более эффективным для организаций с большим объемом данных и низкой частотой изменений. Дифференциальное резервное копирование может быть более эффективным для некоторых организаций, которые хранят большой объем данных, но изменения в них происходят нечасто.

Важно отметить, что независимо от выбранного метода резервного копирования, необходимо регулярно проверять работоспособность резервных копий и их целостность, чтобы убедиться, что данные можно восстановить в случае необходимости. Также следует учитывать потребности в хранении и использовании данных, а также доступность необходимых ресурсов для создания и хранения резервных копий.
## Задание 2. Установите программное обеспечении Bacula, настройте bacula-dir, bacula-sd, bacula-fd. Протестируйте работу сервисов.
### Статус работающих сервисов:
![Снимок экрана (62)](https://user-images.githubusercontent.com/69298696/230907332-a635a556-034c-43ae-aeb2-9d824f555c05.png)
![Снимок экрана (63)](https://user-images.githubusercontent.com/69298696/230907419-b384c4c9-9287-43c5-9563-6e2b52fc9efc.png)
![Снимок экрана (64)](https://user-images.githubusercontent.com/69298696/230907484-ab5ed0fe-eec3-4dd7-91ea-640025aa614a.png)
### Конфиги:
![Снимок экрана (65)](https://user-images.githubusercontent.com/69298696/230907682-9512bc1a-b0f9-40d5-a527-3a0f468141f2.png)
![Снимок экрана (66)](https://user-images.githubusercontent.com/69298696/230907798-b9309603-e3c2-4f34-ad9c-bbaaa9af422a.png)
![Снимок экрана (67)](https://user-images.githubusercontent.com/69298696/230907895-e1a19337-49aa-42ce-81a9-deaf3c215dc2.png)
### Резервное копирование 2 и 3:
![Снимок экрана (59)](https://user-images.githubusercontent.com/69298696/230908077-259ecaac-1589-4e39-8ed0-a631c55d8aae.png)
![Снимок экрана (60)](https://user-images.githubusercontent.com/69298696/230908170-d9b57a59-3f45-4fa7-8916-532492b51f55.png)

## Задание 3. Установите программное обеспечении Rsync. Настройте синхронизацию на двух нодах. Протестируйте работу сервиса.
### Конфигурация на первой машине:
```
pid file = /var/run/rsyncd.pid
log file = /var/log/rsyncd.log
transfer logging = true
munge symlinks = yes
# папка источник для бэкапа
[data]
path = /root/
uid = root
read only = yes
list = yes
comment = Data backup Dir
auth users = backup
secrets file = /etc/rsyncd.scrt
```
### Скрипт для бекапа:
```
#!/bin/bash
date
# Папка, куда будем складывать архивы — ее либо сразу создать либо не
# создавать а положить в уже существующие
syst_dir=/backup/
# Имя сервера, который архивируем
srv_name=test2 #из тестовой конфигурации
# Адрес сервера, который архивируем
srv_ip=192.168.0.6
# Пользователь rsync на сервере, который архивируем
srv_user=backup
# Ресурс на сервере для бэкапа
srv_dir=data
echo "Start backup ${srv_name}"
# Создаем папку для инкрементных бэкапов
mkdir -p ${syst_dir}${srv_name}/increment/
/usr/bin/rsync -avz --progress --delete --password-file=/etc/rsyncd.scrt ${srv_user}@${srv_ip}::${srv_dir>
${syst_dir}${srv_name}/current/ --backup --backup-dir=${syst_dir}${srv_name}/increment/`date +%Y-%m-%d`/
/usr/bin/find ${syst_dir}${srv_name}/increment/ -maxdepth 1 -type d
-mtime +30 -exec rm -rf {} \;
date
echo "Finish backup ${srv_name}"

```
### Конфигурация на второй машине:
```
pid file = /var/run/rsyncd.pid
log file = /var/log/rsyncd.log
transfer logging = true
munge symlinks = yes
# папка источник для бэкапа
[data]
path = /root/
uid = root
read only = yes
list = yes
comment = Data backup Dir
auth users = backup
secrets file = /etc/rsyncd.scrt
```
